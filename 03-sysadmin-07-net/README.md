# Домашнее задание к занятию "3.7. Компьютерные сети, лекция 2"

1. Проверьте список доступных сетевых интерфейсов на вашем компьютере. Какие команды есть для этого в Linux и в Windows?

    >### Windows
    ```
    ipconfig /all
    netsh interface show interface
    ```
    >### Linux  - `ip a`

2. Какой протокол используется для распознавания соседа по сетевому интерфейсу? Какой пакет и команды есть в Linux для этого?

    >### Link Layer Discovery Protocol (LLDP) — протокол канального уровня, который позволяет сетевым устройствам анонсировать в сеть информацию о себе и о своих возможностях, а также собирать эту информацию о соседних устройствах.

3. Какая технология используется для разделения L2 коммутатора на несколько виртуальных сетей? Какой пакет и команды есть в Linux для этого? Приведите пример конфига.

    >### Технология VLAN (Virtual Local Area Network). В ранее использовался пакет `vlan` с командой `vconfig`, сейчас используется `ip net link`. Для статической настройки `sudo nano /etc/network/interfaces`. 
    ```
    auto vlan1400
    iface vlan1400 inet static
            address 192.168.1.1
            netmask 255.255.255.0
            vlan_raw_device eth0
    ```

4. Какие типы агрегации интерфейсов есть в Linux? Какие опции есть для балансировки нагрузки? Приведите пример конфига.

    >* `Mode-0(balance-rr)` – Данный режим используется по умолчанию. Balance-rr обеспечивается балансировку нагрузки и отказоустойчивость. В данном режиме сетевые пакеты отправляются “по кругу”, от первого интерфейса к последнему. Если выходят из строя интерфейсы, пакеты отправляются на остальные оставшиеся. Дополнительной настройки коммутатора не требуется при нахождении портов в одном коммутаторе. При разностных коммутаторах требуется дополнительная настройка.
    >* `Mode-1(active-backup)` – Один из интерфейсов работает в активном режиме, остальные в ожидающем. При обнаружении проблемы на активном интерфейсе производится переключение на ожидающий интерфейс. Не требуется поддержки от коммутатора.
    >* `Mode-2(balance-xor)` – Передача пакетов распределяется по типу входящего и исходящего трафика по формуле ((MAC src) XOR (MAC dest)) % число интерфейсов. Режим дает балансировку нагрузки и отказоустойчивость. Не требуется дополнительной настройки коммутатора/коммутаторов.
    >* `Mode-3(broadcast` – Происходит передача во все объединенные интерфейсы, тем самым обеспечивая отказоустойчивость. Рекомендуется только для использования MULTICAST трафика.
    >* `Mode-4(802.3ad)` – динамическое объединение одинаковых портов. В данном режиме можно значительно увеличить пропускную способность входящего так и исходящего трафика. Для данного режима необходима поддержка и настройка коммутатора/коммутаторов.
    >* `Mode-5(balance-tlb)` – Адаптивная балансировки нагрузки трафика. Входящий трафик получается только активным интерфейсом, исходящий распределяется в зависимости от текущей загрузки канала каждого интерфейса. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.
    >* `Mode-6(balance-alb)` – Адаптивная балансировка нагрузки. Отличается более совершенным алгоритмом балансировки нагрузки чем Mode-5). Обеспечивается балансировку нагрузки как исходящего так и входящего трафика. Не требуется специальной поддержки и настройки коммутатора/коммутаторов.
    Конфиг:
    ```bash
    iface bond0 inet static
            address 192.168.0.11
            netmask 255.255.255.0
            gateway 192.168.0.1
            bond-slaves eth0 eth1
            bond-mode balance-alb # Адаптивная балансировка нагрузки.
    bond-miimon 200
    bond-downdelay 100
    ```

5. Сколько IP адресов в сети с маской /29 ? Сколько /29 подсетей можно получить из сети с маской /24. Приведите несколько примеров /29 подсетей внутри сети 10.10.10.0/24.

    >### Ставим `ipcalc`

    ```bash
    vagrant@vagrant:~$ sudo apt-get install ipcalc
    Reading package lists... Done
    Building dependency tree
    Reading state information... Done
    The following NEW packages will be installed:
    ipcalc
    0 upgraded, 1 newly installed, 0 to remove and 0 not upgraded.
    Need to get 25.9 kB of archives.
    After this operation, 64.5 kB of additional disk space will be used.
    Get:1 http://archive.ubuntu.com/ubuntu focal/universe amd64 ipcalc all 0.41-5 [25.9 kB]
    Fetched 25.9 kB in 1s (51.2 kB/s)
    Selecting previously unselected package ipcalc.
    (Reading database ... 75304 files and directories currently installed.)
    Preparing to unpack .../archives/ipcalc_0.41-5_all.deb ...
    Unpacking ipcalc (0.41-5) ...
    Setting up ipcalc (0.41-5) ...
    Processing triggers for man-db (2.9.1-1) ...
    ```
    >### Считаем
    ```bash
    vagrant@vagrant:~$ ipcalc 192.168.1.1/29
    Address:   192.168.1.1          11000000.10101000.00000001.00000 001
    Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
    Wildcard:  0.0.0.7              00000000.00000000.00000000.00000 111
    =>
    Network:   192.168.1.0/29       11000000.10101000.00000001.00000 000
    HostMin:   192.168.1.1          11000000.10101000.00000001.00000 001
    HostMax:   192.168.1.6          11000000.10101000.00000001.00000 110
    Broadcast: 192.168.1.7          11000000.10101000.00000001.00000 111
    Hosts/Net: 6                     Class C, Private Internet
    ```
    * IP 8
    * Хостов 6

    ```bash
    vagrant@vagrant:~$ ipcalc 10.10.10.0/24 -s 6
    Address:   10.10.10.0           00001010.00001010.00001010. 00000000
    Netmask:   255.255.255.0 = 24   11111111.11111111.11111111. 00000000
    Wildcard:  0.0.0.255            00000000.00000000.00000000. 11111111
    =>
    Network:   10.10.10.0/24        00001010.00001010.00001010. 00000000
    HostMin:   10.10.10.1           00001010.00001010.00001010. 00000001
    HostMax:   10.10.10.254         00001010.00001010.00001010. 11111110
    Broadcast: 10.10.10.255         00001010.00001010.00001010. 11111111
    Hosts/Net: 254                   Class A, Private Internet

    1. Requested size: 6 hosts
    Netmask:   255.255.255.248 = 29 11111111.11111111.11111111.11111 000
    Network:   10.10.10.0/29        00001010.00001010.00001010.00000 000
    HostMin:   10.10.10.1           00001010.00001010.00001010.00000 001
    HostMax:   10.10.10.6           00001010.00001010.00001010.00000 110
    Broadcast: 10.10.10.7           00001010.00001010.00001010.00000 111
    Hosts/Net: 6                     Class A, Private Internet

    Needed size:  8 addresses.
    Used network: 10.10.10.0/29
    Unused:
    10.10.10.8/29
    10.10.10.16/28
    10.10.10.32/27
    10.10.10.64/26
    10.10.10.128/25
    vagrant@vagrant:~$
    ```

6. Задача: вас попросили организовать стык между 2-мя организациями. Диапазоны 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16 уже заняты. Из какой подсети допустимо взять частные IP адреса? Маску выберите из расчета максимум 40-50 хостов внутри подсети.

    >### Если брать в расчет только `IPv4`    Частные диапазоны IP-адресов:
    >* `10.0.0.0 — 10.255.255.255` (маска подсети для бесклассовой (CIDR) адресации: 255.0.0.0 или /8)
    >* `100.64.0.0 — 100.127.255.255` (маска подсети 255.192.0.0 или /10) - Данная подсеть рекомендована согласно RFC 6598 для использования в качестве адресов для CGN (Carrier-Grade NAT).
    >* `172.16.0.0 — 172.31.255.255` (маска подсети: 255.240.0.0 или /12)
    >* `192.168.0.0 — 192.168.255.255` (маска подсети: 255.255.0.0 или /16)

    ```
    vagrant@vagrant:~$ ipcalc 100.64.0.0/10 -s 50
    Address:   100.64.0.0           01100100.01 000000.00000000.00000000
    Netmask:   255.192.0.0 = 10     11111111.11 000000.00000000.00000000
    Wildcard:  0.63.255.255         00000000.00 111111.11111111.11111111
    =>
    Network:   100.64.0.0/10        01100100.01 000000.00000000.00000000
    HostMin:   100.64.0.1           01100100.01 000000.00000000.00000001
    HostMax:   100.127.255.254      01100100.01 111111.11111111.11111110
    Broadcast: 100.127.255.255      01100100.01 111111.11111111.11111111
    Hosts/Net: 4194302               Class A

    1. Requested size: 50 hosts
    Netmask:   255.255.255.192 = 26 11111111.11111111.11111111.11 000000
    Network:   100.64.0.0/26        01100100.01000000.00000000.00 000000
    HostMin:   100.64.0.1           01100100.01000000.00000000.00 000001
    HostMax:   100.64.0.62          01100100.01000000.00000000.00 111110
    Broadcast: 100.64.0.63          01100100.01000000.00000000.00 111111
    Hosts/Net: 62                    Class A

    Needed size:  64 addresses.
    Used network: 100.64.0.0/26
    Unused:
    100.64.0.64/26
    100.64.0.128/25
    100.64.1.0/24
    100.64.2.0/23
    100.64.4.0/22
    100.64.8.0/21
    100.64.16.0/20
    100.64.32.0/19
    100.64.64.0/18
    100.64.128.0/17
    100.65.0.0/16
    100.66.0.0/15
    100.68.0.0/14
    100.72.0.0/13
    100.80.0.0/12
    100.96.0.0/11
    vagrant@vagrant:~$
    ```

7. Как проверить ARP таблицу в Linux, Windows? Как очистить ARP кеш полностью? Как из ARP таблицы удалить только один нужный IP?

    >### linux
    >* Проверить ARP-таблицу: `arp -n` или `ip n`
    >* Очистить ARP кеш полностью: `ip neigh flush` 
    >* Из ARP таблицы удалить только один нужный IP: `arp -d <address>` или `ip n delete`

    >### В `Windows`
    >* `arp -a` -проверить ARP-таблицу
    >* `-d` — удаление IP-адреса (например, arp -d 192.168.100.10)
    >* `-d -a` — удаление всех записей в таблице ARP
    >* `-s` — добавление записи в таблицу ARP (команда arp -s АДРЕС MAC-АДРЕС, где АДРЕС — это адрес, который нужно добавить, а MAC-АДРЕС — MAC-адрес компьютера)
